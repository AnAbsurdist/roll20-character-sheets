
// VARIABLES
//  ============================= *
   $pictos: "pictos";
   $d6: "dicefontd6";
   $padding: 1%;
   $tabs: "core", "arms", "gear", "magic", "matrix", "social", "vehicle", "options";
   $sheets: "pc", "npc";
   $toggles: "attributes", "skills";
   $attributesTotals: "agility", "body", "charisma", "intuition", "logic", "reaction", "special", "strength", "willpower", "initiative", "matrix_initiative", "astral_initiative", "composure", "judge_intentions", "memory", "lift_carry";

   // COLORS
	$accent1  : hsl(305, 98%, 24%);
	$accent2  : hsla(253, 35%, 61%, 0.25);
	$accent3  : #b9dadf;
	$darkaccent: hsl(305, 97%, 14%);
	$black    : hsl(0, 6%, 0%);
	$dark-font: #000;
	$gray     : #4c4c4c;
	$white    : hsl(0, 0%, 96%);

// MIXINS
//  =============================
  @import 'src/scss/_mixins'; 

// FUNCTIONS
//  =============================
	@function alternate($first, $increase) {
		$value: $first;
		@if $first > 1 {
			$value: $first + $increase;
		}

		@return $value;
	}

/* GLOBAL SETTINGS
    =============================  */
  @import 'src/scss/_globals'; 


/* SHARED STYLES
    =============================  */
.charsheet { min-width: 30em; }
.sheet-d6 { font-family: "dicefontd6"; }
.sheet-pictos { 
	font-family: $pictos;
	text-transform: lowercase;
}
.sheet-opacity0 { opacity: 0; }
.sheet-horz-line { @include border(0.1em, solid, $black); }
.sheet-center { text-align: center; }

/* EXTENDED STYLES
    =============================  */
%borderBottom { border-bottom: 1px solid #333; }

%input-border-bottom { border-bottom: 0.15em solid $accent1; }

%display-none { display: none; }
%display-inline { display: inline; }
%display-inline-grid { display: inline-grid; }
%display-grid { display: grid; }

%parantheseNumbers {
	vertical-align: middle;

	&:before { content: '('; }
	&:after { content: ')'; }
}

%toggleCheckbox,
input.sheet-toggle {
	position: absolute;
	opacity: 0;
	z-index: 2;
}

%toggleRelative {
	position: relative;
	opacity: 0;
	z-index: 2;
}

%settingsCheckboxes { 
	& + span { opacity: 0; }
	&:checked + span { opacity: 1; }

	&:checked ~ .sheet-settings {
		display: inline-grid;
		margin-bottom: 2%;
	}
}

%gridGap {
	grid-column-gap: 1%;
	grid-row-gap: 1%;
}


/* SWITCHES
============================= */
    @import 'src/scss/_switch'; 

/* FLEXBOX
   ============================= */
	div.sheet-flex {
		align-items    : flex-start;
		display        : inline-flex;
		flex-direction : row;
		flex-wrap      : wrap;
		justify-content: flex-start;
		max-width      : 100%;
		min-width      : 410px;
		vertical-align : top;
		width          : 45%;

		&:first-child { margin-right: 0.5%; }
	}

/* GRID
   ============================= */ 
	div.sheet-grid {
		display        : inline-grid;
		grid-column-gap: 0.2em;
		grid-row-gap: 0.2em;
	}

/* HIGHLIGHT BUTTONS
   ============================= */
   button.sheet-highlight,
   label.sheet-fake-button input[type="checkbox"]:checked + span {
   		@include back-col($accent1);
		box-shadow: inset 0px 0px 3px 1px $accent2;
		color     : $white
   }

	input.sheet-settings-flag,
	input.sheet-collapse-flag {
		&:checked + span {  color: $accent1; }
	}

	@each $sheet in $sheets {
		input.sheet-type[value="#{$sheet}"] ~ div.sheet-tabs button[name="#{$sheet}"] { 
			@extend button.sheet-highlight;
		}
	}

	@each $tab in $tabs {
		input.sheet-display_string[value="#{$tab}"] ~ div.sheet-tabs button[name*="#{$tab}"] { 
			@extend button.sheet-highlight;
		}
	}

/* TABS & LOGO SECTION
   ============================= */
	div.sheet-tabs {
		margin-bottom: 2%;

		label > input[type="text"] {
			width: 100%;
		}

		div.sheet-grid-tab-sheets {
			grid-template-columns: 6em 6em 6em 1fr;
			width: 100%;
		}
	}

	/* INPUTS FOR CHARACTER, PLAYER, NOTES..... */
	div.sheet-grid-tab-inputs {
		grid-template-columns: 8em 73%;
		width: 100%;

		h2 {
			font-size: 1.5em;
		}

		label {
			@include border(0.15em, solid, $black);
		}

		span {
			font-weight   : bold;
			text-transform: uppercase;
		}
	}

	div.sheet-grid-tab-options {
		font-size: 1.1em;
		font-variant: small-caps;
		font-weight: bold;
		grid-template-columns: 2.5em 1fr 1fr 1fr 1fr;
		text-align: center;
		text-overflow: ellipsis;
		text-transform: capitalize;

		button { grid-area: 2 / 1 / 2 / 1; }

		h2 { grid-row: 1; }

		label.sheet-switch {
			margin-left: 20%;
			@for $i from 1 through 4 {
		   		&:nth-of-type(#{$i})  { 
		   			@include grid-area(2, $i+1, 2, $i+1);
		   		}
			}
		}

		input[type="checkbox"] { margin-right: 2%; }
	}


/* NPC SHEET
    ============================= */

/* PC SHEET
   ============================= */

	div.sheet-pc {
		div.sheet-bot-border { @include border(0.1em, solid, $black); }

		div.sheet-info-flex {
			width: 100%;

			div.sheet-grid-tab-buttons {
				grid-template-columns: 6em 6em 6em 6em 6em 6em 6em 6em 2.5em;
			}
		}

		div.sheet-grid-header {
	   		grid-template-columns: 10em 2.5em 2.5em 10em 2.5em 2.5em;

		   button {
		   		@include oldgrid-area(1, 1, 1, 1);
		   		font-family: $pictos;
				height: 2em;
				width: 2em;
		   }

		   h1 {
		   		margin-left: 10%;
		   		@include oldgrid-area(1, 7, 1, 1);
		   }

		   h2 {
		   		font-size: 0.8em;
		   		text-transform: uppercase;
			   	@for $i from 1 through 2 {
			   		&:nth-of-type(#{$i})  { 
			   			@include oldgrid-area($i+1, $i+1, 2, 2); 
			   		}
				}

				@for $i from 3 through 4 {
			   		&:nth-of-type(#{$i})  { 
			   			@include oldgrid-area($i+2, $i+2, 2, 2);
			   		}
				}
		   }

		   hr {
		   		@include oldgrid-area(1, 7, 3, 3);
		   }
	   }

	   	div.sheet-border {
			border       : 0.15em solid $accent1;
			border-radius: 0.8em;
			margin-bottom: 2%;
			padding: 2% 1%;
		}

		div.sheet-subheader {
			h2 {font-size: 1.2em;}
			h2:nth-of-type(1n+2) { text-align: center; }
		}

	/* REPEATING CONTAINERS
	   ----------------------------- */
		div.sheet-repeating-container {
			div.repitem {
				display: inline-grid;
				padding: 1% 0.5%;
				margin-bottom: 2%;
				width: 100%;

				@extend %gridGap;
				@extend %borderBottom;

				h3 { font-size: 1em;}

				button[type='roll'] { 
					font-size: 1em;
					text-align: left;
					padding: 1% 2% !important;
				}

				input { 
					&:nth-of-type(1n+2) { text-align: center; } 

					&[type='text']{ 
						@extend %borderBottom;
						width: 100%; 
					}

					&[type='number'] { 
						text-align: center;
						@extend %borderBottom;
						width: 3.5em; 
					}

					&.sheet-flag {
						display: absolute;
						opacity: 0;
						width: 100%;
						z-index: 2;
					}
				}

				label { 
					padding-right: 0px;

					input[name='attr_name'] { text-align: left;  }

					&[data-i18n-title='modifier'] {
						width: 3em;
					}
				}

				div.sheet-settings { 
					background-color: $accent2 ;
					border-left: 2px solid $gray;
					@extend %gridGap;
					margin-bottom: 2%;
					padding: 2% 1%;
					width: 100%;

					select { text-transform: capitalize; }
				}

				div.sheet-collapse { padding-left: 5%; }
			}
		}

	/* PERSONAL DATA
	   ----------------------------- */
	   div.sheet-personal-data {
	   		div { 
	   			display: inline-block;
	   			&.sheet-grid-row {
	   				display: grid;
	   				grid-column-gap: 1%;
		   			border-bottom: 1px solid $black;
		   		}

		   		&.sheet-name-alias { grid-template-columns: 35% 1fr; }
		   		&.sheet-metatype-ethnic {grid-template-columns: 18% 1fr 18% 1fr;}
		   		&.sheet-age-weigth {grid-template-columns: 8% 1fr 8% 2fr 12% 2fr 12% 2fr;}
	   			&.sheet-rep-heat {grid-template-columns: 20% 1fr 10% 1fr}
	   			&.sheet-karma-misc {grid-template-columns: 11% 1fr 22% 1fr 8% 2fr}
	   		}

	   		h2 { 
	   			font-size: 0.9em;
	   			line-height: 2.3em;
	   			text-overflow: ellipsis;
	   			text-transform: uppercase;
	   		}

	   		label {
	   			display: inline-block;
	   			vertical-align: middle;
	   		}
	   }

	 /* ATTRIBUTES
	   ----------------------------- */
	   div.sheet-grid-attributes {
	   		div.sheet-grid-body { width: 49.5%; }

	   		button {
	   			&[type="roll"] {
					border-bottom : {
						left-radius : 0em;
						right-radius: 0em;
					}
					@include button-like();
				}
	   		}

	   		h2 {
	   			@include text-align(right);
	   			padding-right: 2%;
	   		}

	   		input {
	   			@include text-align(center);
	   			&[type="hidden"][value=""] ~ div.sheet-grid div > span.sheet-total,
		   		&[type="hidden"][value="0"] ~ div.sheet-grid div > span.sheet-total,
		   		&[type="hidden"][value="0"] ~ div.sheet-grid div > span.sheet-total::after,
		   		&[type="hidden"][value="0"] ~ div.sheet-grid div > span.sheet-total::before {
		   			display: none;
		   		}

				&[type="text"],
				&[type="number"] { 
					@extend %input-border-bottom;
					width: 3.5em;
				}
	   		}

			@for $i from 1 through 11 {
				div.sheet-grid-row:nth-of-type(#{$i})  { 
					@include oldgrid-area(1, 3, $i, $i);
				}
			}

		   div.sheet-grid-row {
				grid-template-columns: 10em 1fr;
				margin-bottom: 2%;

		   		button, h2.sheet-label { 
					@include oldgrid-area(1, 1, 1, 1);
				}

				div.sheet-display { 
					@include oldgrid-area(2, 2, 1, 1);
					text-align: center;

					span {
						&.sheet-total::after { content: ")"; }
				   		&.sheet-total::before { content: "("; }
					}
				}

				div.sheet-settings { 
					@include oldgrid-area(1, 4, 2, 2);
					grid-template-columns: 1fr 1fr 1fr 1fr;

					div.sheet-arrow-up {
						@include oldgrid-area(2, 3, 1, 1);
					}

					h2 {
						@for $i from 1 through 2 {
							&:nth-of-type(#{$i})  { 
								@include oldgrid-area(alternate($i, 1), alternate($i, 1), 2, 2);
							}
						}

						&:nth-of-type(3) { @include oldgrid-area(1, 1, 3, 3); }
						&:nth-of-type(4) { @include oldgrid-area(3, 3, 3, 3); }
					}

					label {
						@for $i from 1 through 2 {
							&:nth-of-type(#{$i})  { 
								@include oldgrid-area(alternate($i, 1)+1, alternate($i, 1)+1, 2, 2);
							}
						}

						&:nth-of-type(3) { @include oldgrid-area(2, 2, 3, 3); }
						&:nth-of-type(4) { @include oldgrid-area(4, 4, 3, 3); }
					}
				}
			}

	   		div.sheet-grid-pc-edge {
				grid-template-columns: 10% 10% 10% 10% 10% 10% 10% 10% 10%;
				grid-column-gap: 0px;
				input[type='checkbox'] {
					opacity: 0;
				}
				span {
					position: relative;
					left: -1%;
				}
		   	}
	   	}

	   	span.sheet-total {
	   		display: none;
	   	}

	   /* SKILLS
	   ----------------------------- */
		div.sheet-grid-skills {
			$skillGrid: 1fr 3.5em 5em 5em 1em 1em;

			div.sheet-subheader {
				grid-template-columns: $skillGrid;
			}

			div.repitem {
				@extend %display-grid;
				grid-template-columns: $skillGrid;

				@include border(0.1em, solid, $black);
				@include repeatingInformation(7, false);

				div.sheet-settings { 
					grid-column: 1 / 7;
					grid-template-columns: $skillGrid;

					/* NAME, RANK, TYPE */
					div.sheet-type {
						grid-column: 4 / 7;

						h3 { display: inline;}
						select {
							display: inline;
							width: 66%;
						}
					}

					div.sheet-modification,
					div.sheet-specialization,
					div.sheet-focus {
						grid-column: 1 / 7;
					}
				}
			}
		}

	   /* CORE COMBAT INFO
	   ----------------------------- */
	}

 /* SHARED SETTINGS
   ============================= */ 
   div.sheet-settings {
		border-left: 0.2em solid $accent1;
		margin-left: 1%;
   		background: $accent2;

	   	div.sheet-arrow-up {
			border-bottom: 5px solid $accent1;
			border-left  : 5px solid transparent;
			border-right : 5px solid transparent;
			height       : 0; 
			left         : 21%;
			position     : relative;
			width        : 0; 
		}

		h2 {
			text-transform: capitalize;
		}
   }

/* SHOW & HIDE SETTINGS 
	============================= */
	div.sheet-settings { @extend %display-none; }

	input.sheet-settings-flag:checked ~ div.sheet-settings { display   : inherit; }
	input.sheet-collapse-flag:checked ~ div.sheet-collapse { display: block; }

	div.sheet-grid-attributes {
		div.sheet-settings {
			-webkit-transition: all .5s; /* Safari */
			display: none; //Hide settings by default
			height: 0;
			overflow: hidden;
			position: relative;
			transition: all .5s;
			z-index: 1;
		}

		div.sheet-settings::before {
		    border-bottom: 10px solid rgb(121, 1, 111);
		    border-left: 10px solid transparent;
		    border-right: 10px solid transparent;
		    content: "";
		    left: 49%;
		    position: absolute;
		    top: -10px;
		    z-index: -1;
		}
	}


	//TOGGLES TO SHOW / HIDE SETTINGS
	div.sheet-toggle {
		display: inline-grid; //Show value's settings if they are part of the toggles string
		height: auto;
		margin-top: 3%;
		margin-bottom: 3%;
		padding: 3% 1%;
	}

	// MODIFIED ATTRIBUTE TOTALS
	span.sheet-inline {
		display: inline;
	}

   	@each $attribute in $attributesTotals {
		input[name="attr_toggles"][value*="#{$attribute}_total"] ~ div.sheet-pc div.sheet-grid-attributes span[name="attr_#{$attribute}"] {
			@extend %display-inline;
		}
	}

// HEXES
@import 'src/scss/_hexs.scss'; 


/* SHOW & HIDE CHARACTER SHEETS & TABs 
	============================= */
	%display-none { display: none; }
	%display-inline-block { display: inline; }

	@each $sheet in $sheets {
		input.sheet-type:not([value="#{$sheet}"]) ~ div.sheet-#{$sheet} { 
			@extend %display-none;
		}
	}

	@each $tab in $tabs {
		input.sheet-display_string:not([value*="#{$tab}"]) ~ ~ div.sheet-pc div.sheet-#{$tab} {
			@extend %display-none;
		}
	}

	$tabs:'arms', 'augs', 'core', 'gear', 'options', 'social', 'magic', 'matrix', 'vehicle';
	@each $tab in $tabs {
		.sheet-#{$tab} { @extend %display-none; }
		.sheet-options_toggle[value="#{$tab}"] ~ .sheet-#{$tab} { @extend %display-inline-block; }
	}

/* FOOTER
   ============================= */
	div.sheet-footer {
		@include text-align(left);
		border     : none;
		font-size  : 0.55em;
		line-height: 15px;
		margin-top : 2%;
		width      : 100%;
	}

/* REPEATING SECTION
   ============================= */
	.repcontainer .repitem {

	};

	/* This will make the Add & Modify words transparent so that only our symbols below show up */
	 button.btn.repcontrol_add,
	 button.btn.repcontrol_edit  {
	 	color: transparent;
	 }

	 /* This will put icons next to the buttons. A `+` for Add and a lock for edit */
	.repcontrol .repcontrol_edit:after,
	.repcontrol .repcontrol_add:after  {
	 	color           : #111518;
	 	font-family     : pictos;
	    font-size       : 2.5em;}

	.repcontrol .repcontrol_edit:after {
		content: '(';
	}

	.repcontrol .repcontrol_add:after {
		content: '&';
	}

	.editmode ~ .repcontrol .repcontrol_edit:after {
		content: ')';
	}

	/* These are the buttons that appear after the repcontrol_edit is clicked*/
	.itemcontrol {
		z-index: 10;
	}

	.itemcontrol .repcontrol_del,
	.itemcontrol .repcontrol_move {
	    font-size: 18px;
	    margin-top: 0px;
	    padding: 0px;
	    width: 15px;}

	.itemcontrol .repcontrol_del {
		@include back-col($accent1);
		font-family: $pictos;
	}

/* ROLL TEMPLATE
   ============================= */
	.sheet-rolltemplate-rolls {

	}

	.sheet-rolltemplate-rolls .sheet-template-body {
		border    : 1px solid #000;
		@include text-align(center);
	}

	.sheet-rolltemplate-rolls .sheet-template-header {
		text-transform: capitalize;
		@include text-align(center);
		font-variant: small-caps;
		@include back-col($white);
		border          : 1px solid #000;
		border-bottom   : 2px solid #000;
		color           : black;
		font-size       : 20px;
		letter-spacing  : 2px;
		padding         : 4px 0px 3px 0px;
	}

	.sheet-rolltemplate-rolls .sheet-template-row {
		@include back-col(#555);
	}

	/* Use this to alternate the background colors for each row */
	.sheet-rolltemplate-rolls .sheet-template-row:nth-child(2n+0) {
		@include back-col(#1c1c1c);
	}

	/* Remove some fo the built in styles around rolls */
	.sheet-rolltemplate-rolls .inlinerollresult {
		@include back-col(transparent);
		border          : none;
		color           : $dark-font;
		display         : inline-block;
		font-size       : 25px;
		padding         : 5px;
	}

	.sheet-rolltemplate-rolls .inlinerollresult.fullfail,
	.sheet-rolltemplate-rolls .inlinerollresult.fullcrit,
	.sheet-rolltemplate-rolls.inlinerollresult.importantroll {
		border: none;
	}

	/* Change the colors of Full Fails & Full Crits from their built in defaults */
	.sheet-rolltemplate-rolls .inlinerollresult.fullfail {
		color: $white;
	}

	.sheet-rolltemplate-rolls .inlinerollresult.fullcrit {
		color: $white;
	}

/* FIREFOX
   ============================= */
	input[type=number]:-webkit-outer-spin-button,
	input[type=number]:-webkit-inner-spin-button {
	    -webkit-appearance: none;
	    margin: 0;}

	input[type=number] {
	    -moz-appearance:textfield;}

/* SCREEN READER ADJUSTMENTS
    =============================  */

.sheet-hidden {
	clip     : rect(1px, 1px, 1px, 1px);
	clip-path: inset(50%);
	height   : 1px;
	margin   : -1px;
	overflow : hidden;
	padding  : 0;
	position : absolute;
	width    : 1px;
}

/********************************************************************************************************/
/**************************************** REPEATING SECTIONS *******************************************/
/********************************************************************************************************/
	@import 'src/scss/_repeatingsection'; 

/********************************************************************************************************/
/**************************************** Roll template *******************************************/
/********************************************************************************************************/

	@import 'src/scss/_rolltemplate';

/* LANGUAGE ADJUSTMENTS
    =============================  */